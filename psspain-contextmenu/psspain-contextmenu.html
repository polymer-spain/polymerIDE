<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../api/api.html">
<polymer-element name="psspain-contextmenu">
    <template>
        <link rel="stylesheet" href="psspain-contextmenu.css">

            <ul class="vertical">
                <template repeat="{{ items }}" id="t">
                   <li>
                        <template if="{{ !children }}">
                            <a href="#">{{name}}</a>
                        </template>
                        <template if="{{ children }}">
                             <a href="#">{{name}}</a>
                             <ul>
                                <template ref="t" repeat="{{ children }}"></template>
                            </ul>
                        </template>
                   </li>
                </template>
            </ul>

    </template>
    <script>
        (function(scope){

            var commandManager  =     scope.commandManager,
                commands        =     scope.Commands;

            Polymer('psspain-contextmenu',{
                ready:function(){

                    // Register Command
                    commandManager.register(commands.CONTEXTMENU_OPEN,this.open.bind(this));
                    commandManager.register(commands.CONTEXTMENU_CLOSE,this.close.bind(this));

                    this.$.t.model={
                    'items': [
                      {
                        'name': 'Africa',
                        'children': [
                          {
                            'name': 'Egypt'
                          },
                          {
                            'name': 'Kenya',
                            'children': [
                              {
                                'name': 'Nairobi'
                              },
                              {
                                'name': 'Mombasa'
                              }
                            ]
                          },
                          {
                            'name': 'Sudan',
                            'children': [{
                              'name': 'Khartoum'
                            }]
                          }
                        ]
                      },
                      {
                        'name': 'Asia',
                        'children': [
                          {
                            'name': 'China'
                          },
                          {
                            'name': 'India'
                          },
                          {
                            'name': 'Russia'
                          },
                          {
                            'name': 'Mongolia'
                          }
                        ]
                      },
                      {
                        'name': 'Australia',
                        'children':[{
                          'name': 'Commonwealth of Australia'
                        }]
                      },
                      {
                        'name': 'Europe',
                        'children': [
                          {
                            'name': 'Germany'
                          },
                          {
                            'name': 'France'
                          },
                          {
                            'name': 'Spain'
                          },
                          {
                            'name': 'Italy'
                          }
                        ]
                      },
                      {
                        'name': 'North America',
                        'children': [
                          {
                            'name': 'Mexico',
                            'children': [
                              {
                                'name': 'Mexico City'
                              },
                              {
                                'name': 'Guadalajara'
                              }
                            ]
                          },
                          {
                            'name': 'Canada',
                            'children': [
                              {
                                'name': 'Ottawa'
                              },
                              {
                                'name': 'Toronto'
                              }
                            ]
                          },
                          {
                            'name': 'United States of America'
                          }
                        ]
                      },
                      {
                        'name': 'South America',
                        'children': [
                          {
                            'name': 'Brazil'
                          },
                          {
                            'name': 'Argentina'
                          }
                        ]
                      }
                    ]
                  };

                },
                open:function(ev){
                    this.style.display      =   'block';
                    this.style.position     =   'absolute';
                    this.style.left         =   ev.clientX + 'px';
                    this.style.top          =   ev.clientY+ 'px';
                    ev.preventDefault();
                },
                close:function(ev){
                    this.style.display='none';
                    if(ev){
                        ev.preventDefault();
                        ev.stopPropagation();
                    }
                }

            });
        }(PSspain.api));
    </script>
</polymer-element>
